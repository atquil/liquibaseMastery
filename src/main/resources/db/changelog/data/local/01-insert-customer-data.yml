# ============================================
# üìä LIQUIBASE CHANGESET: LOCAL TEST DATA
# ============================================
# Purpose: Insert test data for local development only
# Context: 'local' - Only runs when context includes 'local'
# Security: Never runs in production
# ============================================

databaseChangeLog:
  - changeSet:
      # üÜî UNIQUE IDENTIFIER
      # Pattern: [action]-[table]-[data]-[context]
      id: insert-customer-data-local-only

      # üë§ AUTHOR
      author: atquil

      # üè∑Ô∏è CONTEXT FILTER (CRITICAL)
      # Purpose: Control when this changeset executes
      # Contexts: local, dev, test, prod, ref, etc.
      # ‚ùó This changeset ONLY runs when context includes 'local'
      # ‚ùó Example: SPRING_LIQUIBASE_CONTEXTS=local
      # ‚ùó Production will NEVER run this (context mismatch)
      context: local

      # üìù CONTEXT-SPECIFIC COMMENT
      comment: "Insert Customer Data for local development environment only"

      # üóÑÔ∏è DATABASE RESTRICTION
      dbms: postgresql

      # ============================================
      # üì• DATA INSERTION
      # ============================================
      changes:
        - sql:
            sql: |
              -- üéØ LOCAL DEVELOPMENT DATA
              -- Purpose: Provide realistic test data for developers
              -- These records should NEVER exist in production
              
              -- üî¢ BATCH INSERT
              -- Syntax: INSERT INTO table (columns) VALUES (values)
              -- Best Practice: Use explicit column names
              INSERT INTO CUSTOMER (username, email)
              VALUES 
                ('emp1', 'emp1@example.com'),
                ('emp2', 'emp2@example.com'),
                ('emp3', 'emp3@example.com');
              
              -- üìä OPTIONAL: Verification query
              -- Uncomment to verify insertion in logs
              -- SELECT 'Inserted ' || COUNT(*) || ' test customers' FROM CUSTOMER;

        # ============================================
        # ‚Ü©Ô∏è ROLLBACK (Data Cleanup)
        # ============================================
        # Purpose: Remove test data during rollback
        # Best Practice: Delete only the data you inserted
        - rollback:
            sql: |
              -- üóëÔ∏è TARGETED DELETION
              -- DELETE FROM table WHERE condition
              -- ‚ùó Safer than TRUNCATE (preserves other data)
              -- ‚ùó More precise than DROP TABLE
              DELETE FROM CUSTOMER 
              WHERE username IN ('emp1', 'emp2', 'emp3');
              
              -- üìù OPTIONAL: Rollback verification
              -- Uncomment to log rollback results
              -- SELECT 'Rollback: Removed ' || COUNT(*) || ' test customers' 
              -- FROM CUSTOMER 
              -- WHERE username IN ('emp1', 'emp2', 'emp3');