databaseChangeLog:
  - changeSet:
      id: create-employee-all-in-one
      author: atul
      comment: Create employee table with constraint and index in one changeset
      changes:
        - createTable:
            tableName: employee
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: username
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
              - column:
                  name: email
                  type: VARCHAR(100)
                  constraints:
                    nullable: false
              - column:
                  name: created_at
                  type: TIMESTAMP WITH TIME ZONE
                  defaultValueComputed: CURRENT_TIMESTAMP
              - column:
                  name: updated_at
                  type: TIMESTAMP WITH TIME ZONE
                  defaultValueComputed: CURRENT_TIMESTAMP

        - addUniqueConstraint:
            tableName: employee
            columnNames: email
            constraintName: uk_employee_email

        - createIndex:
            tableName: employee
            indexName: idx_employee_username
            columns:
              - column:
                  name: username

      rollback:
        - dropIndex:
            tableName: employee
            indexName: idx_employee_username
        - dropUniqueConstraint:
            tableName: employee
            constraintName: uk_employee_email
        - dropTable:
            tableName: employee

###### OR ######
#  - changeSet:
#      id: employee-multi-sql
#      author: atquil
#      comment: Create employee table and add index in one changeset
#      changes:
#        - sql:
#            sql: |
#              CREATE TABLE employee (
#                  id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
#                  username VARCHAR(50) NOT NULL,
#                  email VARCHAR(100) NOT NULL
#              );
#
#              ALTER TABLE employee ADD CONSTRAINT uk_employee_email UNIQUE (email);
#
#              CREATE INDEX idx_employee_username ON employee(username);
#      rollback:
#        - sql:
#            sql: |
#              DROP INDEX idx_employee_username;
#              ALTER TABLE employee DROP CONSTRAINT uk_employee_email;
#              DROP TABLE employee;


